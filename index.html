<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goal Setting Workshop - Tony Robbins Day 12</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        coral: '#e07a5f',
                        sunset: '#3d405b',
                        golden: '#f2cc8f',
                        cream: '#faf7f2',
                        sage: '#81b29a',
                        peach: '#fcd5ce'
                    },
                    fontFamily: {
                        display: ['Playfair Display', 'serif'],
                        body: ['Nunito', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Nunito', sans-serif; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }
        .gradient-bg {
            background: linear-gradient(135deg, #faf7f2 0%, #fcd5ce 50%, #f4a261 100%);
        }
        .gradient-warm {
            background: linear-gradient(135deg, #e07a5f 0%, #f4a261 100%);
        }
        .timer-ring {
            transform: rotate(-90deg);
        }
        .timer-ring circle {
            transition: stroke-dashoffset 1s linear;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-warning {
            animation: pulse 1s ease-in-out infinite;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        .confetti {
            animation: confetti-fall 3s ease-out forwards;
        }
        /* Accordion transitions */
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-content.expanded {
            max-height: 2000px;
            transition: max-height 0.5s ease-in;
        }
        /* Print styles */
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white !important; }
            .gradient-bg { background: white !important; }
        }
        .print-only { display: none; }
        /* Scrollbar styling */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #e07a5f; border-radius: 3px; }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Profile Selection Screen -->
    <div id="profileScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white/90 backdrop-blur rounded-3xl shadow-2xl p-8 max-w-lg w-full text-center">
            <h1 class="text-4xl font-display font-bold text-sunset mb-2">Goal Setting Workshop</h1>
            <p class="text-coral text-lg mb-2">Tony Robbins - Personal Power Day 12</p>
            <p class="text-gray-600 mb-8">Create your compelling future as a family</p>

            <div class="mb-8">
                <label class="block text-sunset font-semibold mb-3">Who's doing the workshop?</label>
                <div class="grid grid-cols-3 gap-3" id="profileButtons">
                    <button onclick="selectProfile('Charles')" class="profile-btn bg-coral/10 hover:bg-coral/20 text-coral font-semibold py-4 px-6 rounded-xl transition-all hover:scale-105 border-2 border-transparent hover:border-coral">
                        Charles
                    </button>
                    <button onclick="selectProfile('Marie')" class="profile-btn bg-golden/30 hover:bg-golden/50 text-sunset font-semibold py-4 px-6 rounded-xl transition-all hover:scale-105 border-2 border-transparent hover:border-golden">
                        Marie
                    </button>
                    <button onclick="selectProfile('Alexandria')" class="profile-btn bg-sage/20 hover:bg-sage/30 text-sage font-semibold py-4 px-6 rounded-xl transition-all hover:scale-105 border-2 border-transparent hover:border-sage">
                        Alexandria
                    </button>
                </div>
            </div>

            <div class="mb-6">
                <label class="block text-sunset font-semibold mb-2">Or enter a new name:</label>
                <input type="text" id="customName" placeholder="Enter name..."
                    class="w-full px-4 py-3 rounded-xl border-2 border-golden/50 focus:border-coral focus:outline-none text-center text-lg">
            </div>

            <button onclick="startWorkshop()"
                class="gradient-warm text-white font-bold py-4 px-8 rounded-xl text-lg hover:opacity-90 transition-all hover:scale-105 shadow-lg">
                Begin Workshop
            </button>

            <p class="text-gray-500 text-sm mt-6">Your goals are saved locally on this device</p>
        </div>
    </div>

    <!-- Main Workshop Screen -->
    <div id="workshopScreen" class="hidden min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white/80 backdrop-blur shadow-sm sticky top-0 z-50 no-print">
            <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <span class="text-2xl">üéØ</span>
                    <div>
                        <h2 class="font-display font-bold text-sunset">Goal Setting Workshop</h2>
                        <p class="text-sm text-coral" id="currentUser">Charles's Goals</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button onclick="switchProfile()" class="text-sunset hover:text-coral transition-colors text-sm">
                        Switch Profile
                    </button>
                    <button onclick="showSummary()" class="bg-sage text-white px-4 py-2 rounded-lg hover:bg-sage/80 transition-colors">
                        View Summary
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content: Video + Writing Cards Side by Side -->
        <main class="flex-1 max-w-7xl mx-auto p-4 w-full">
            <div class="grid lg:grid-cols-2 gap-6 h-full">
                <!-- Left: Video Panel -->
                <div class="bg-white/90 backdrop-blur rounded-2xl shadow-xl overflow-hidden flex flex-col">
                    <div class="relative bg-black">
                        <video id="workshopVideo" class="w-full" controls>
                            <source src="video/tony-robbins-day12.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <div class="p-4 bg-sunset/5 flex-1">
                        <p class="text-sunset font-semibold mb-2">üé¨ You control the video!</p>
                        <p class="text-gray-600 text-sm">Watch together as a family. When Tony says "begin" or "start", pause the video and use the writing sections on the right.</p>
                        <div class="mt-4 p-3 bg-golden/20 rounded-lg">
                            <p class="text-sm text-sunset"><strong>Tip:</strong> Keep your pen moving during brainstorming! Don't stop to think - just write.</p>
                        </div>
                    </div>
                </div>

                <!-- Right: Writing Sections (Accordion Cards) -->
                <div class="bg-white/90 backdrop-blur rounded-2xl shadow-xl p-4 overflow-y-auto custom-scroll" style="max-height: calc(100vh - 120px);">
                    <h3 class="text-xl font-display font-bold text-sunset mb-4">üìù Writing Sections</h3>
                    <p class="text-gray-600 text-sm mb-4">Click a section to expand. Your work saves automatically.</p>

                    <!-- Section 1: Personal Development Goals -->
                    <div class="accordion-card mb-3" data-section="personal">
                        <button onclick="toggleAccordion('personal')" class="w-full flex items-center justify-between p-4 bg-coral/10 hover:bg-coral/20 rounded-xl transition-all">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">üå±</span>
                                <div class="text-left">
                                    <p class="font-semibold text-sunset">1. Personal Development Goals</p>
                                    <p class="text-sm text-gray-500">Who you want to become (6 min)</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span id="personal-check" class="text-sage hidden">‚úì</span>
                                <span id="personal-arrow" class="text-coral transition-transform">‚ñº</span>
                            </div>
                        </button>
                        <div id="personal-content" class="accordion-content">
                            <div class="p-4 border-t border-coral/20">
                                <div class="bg-golden/20 rounded-lg p-3 mb-3 italic text-sunset text-sm">
                                    "Who do you want to become? What fears do you want to conquer? What would you like to learn? Where would you like to go? What character traits do you want?"
                                </div>
                                <div class="flex items-center justify-between mb-2">
                                    <button onclick="startSectionTimer('personal', 360)" class="text-sm bg-coral/20 hover:bg-coral/30 text-coral px-3 py-1 rounded-lg transition-colors">
                                        ‚è±Ô∏è Start 6 min timer
                                    </button>
                                    <span id="personal-timer" class="text-coral font-bold"></span>
                                </div>
                                <textarea id="personal-goals" onchange="saveGoals('personal')" oninput="autoSave('personal')"
                                    class="w-full h-48 p-3 rounded-xl border-2 border-coral/30 focus:border-coral focus:outline-none resize-none"
                                    placeholder="Write each goal on a new line...&#10;&#10;Examples:&#10;- Learn to speak Spanish&#10;- Read 24 books this year&#10;- Run a marathon&#10;- Become more patient"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Section 2: Thing Goals -->
                    <div class="accordion-card mb-3" data-section="things">
                        <button onclick="toggleAccordion('things')" class="w-full flex items-center justify-between p-4 bg-golden/20 hover:bg-golden/30 rounded-xl transition-all">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">‚ú®</span>
                                <div class="text-left">
                                    <p class="font-semibold text-sunset">2. Thing Goals</p>
                                    <p class="text-sm text-gray-500">Fun stuff with no limits (2.5 min)</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span id="things-check" class="text-sage hidden">‚úì</span>
                                <span id="things-arrow" class="text-golden transition-transform">‚ñº</span>
                            </div>
                        </button>
                        <div id="things-content" class="accordion-content">
                            <div class="p-4 border-t border-golden/20">
                                <div class="bg-golden/20 rounded-lg p-3 mb-3 italic text-sunset text-sm">
                                    "Imagine you're a little kid again with NO limits. What do you want to have, do, or create? Cars? Homes? Travel? A yacht? A helicopter?"
                                </div>
                                <div class="flex items-center justify-between mb-2">
                                    <button onclick="startSectionTimer('things', 150)" class="text-sm bg-golden/30 hover:bg-golden/40 text-sunset px-3 py-1 rounded-lg transition-colors">
                                        ‚è±Ô∏è Start 2.5 min timer
                                    </button>
                                    <span id="things-timer" class="text-sunset font-bold"></span>
                                </div>
                                <textarea id="things-goals" onchange="saveGoals('things')" oninput="autoSave('things')"
                                    class="w-full h-48 p-3 rounded-xl border-2 border-golden/30 focus:border-golden focus:outline-none resize-none"
                                    placeholder="Write each goal on a new line...&#10;&#10;Examples:&#10;- Beach house in Hawaii&#10;- Tesla Model S&#10;- Trip to Japan&#10;- Home theater"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Section 3: Financial Goals -->
                    <div class="accordion-card mb-3" data-section="financial">
                        <button onclick="toggleAccordion('financial')" class="w-full flex items-center justify-between p-4 bg-sage/20 hover:bg-sage/30 rounded-xl transition-all">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">üí∞</span>
                                <div class="text-left">
                                    <p class="font-semibold text-sunset">3. Financial Goals</p>
                                    <p class="text-sm text-gray-500">Money, investments, giving (2 min)</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span id="financial-check" class="text-sage hidden">‚úì</span>
                                <span id="financial-arrow" class="text-sage transition-transform">‚ñº</span>
                            </div>
                        </button>
                        <div id="financial-content" class="accordion-content">
                            <div class="p-4 border-t border-sage/20">
                                <div class="bg-sage/20 rounded-lg p-3 mb-3 italic text-sunset text-sm">
                                    "What do you want to earn per month? Per year? What's your net worth goal? Investment goals? Retirement? What do you want to give each year?"
                                </div>
                                <div class="flex items-center justify-between mb-2">
                                    <button onclick="startSectionTimer('financial', 120)" class="text-sm bg-sage/30 hover:bg-sage/40 text-sunset px-3 py-1 rounded-lg transition-colors">
                                        ‚è±Ô∏è Start 2 min timer
                                    </button>
                                    <span id="financial-timer" class="text-sunset font-bold"></span>
                                </div>
                                <textarea id="financial-goals" onchange="saveGoals('financial')" oninput="autoSave('financial')"
                                    class="w-full h-48 p-3 rounded-xl border-2 border-sage/30 focus:border-sage focus:outline-none resize-none"
                                    placeholder="Write each goal on a new line...&#10;&#10;Examples:&#10;- Earn $10,000/month&#10;- Net worth of $1M by age 50&#10;- Max out retirement accounts&#10;- Give $500/month to charity"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Section 4: Timelines & Top 3 -->
                    <div class="accordion-card mb-3" data-section="top3">
                        <button onclick="toggleAccordion('top3')" class="w-full flex items-center justify-between p-4 bg-coral/10 hover:bg-coral/20 rounded-xl transition-all">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">üéØ</span>
                                <div class="text-left">
                                    <p class="font-semibold text-sunset">4. Timelines & Top 3</p>
                                    <p class="text-sm text-gray-500">Pick your most exciting 1-year goals</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span id="top3-check" class="text-sage hidden">‚úì</span>
                                <span id="top3-arrow" class="text-coral transition-transform">‚ñº</span>
                            </div>
                        </button>
                        <div id="top3-content" class="accordion-content">
                            <div class="p-4 border-t border-coral/20">
                                <p class="text-sm text-gray-600 mb-4">Select your <strong>Top 3 one-year goals</strong> from each category. These should really excite you!</p>

                                <!-- Personal Top 3 -->
                                <div class="mb-4">
                                    <p class="font-semibold text-coral mb-2">üå± Personal Development - Top 3:</p>
                                    <div id="personal-top3-list" class="space-y-2 mb-2"></div>
                                    <textarea id="personal-why" onchange="saveWhy('personal')" oninput="autoSaveWhy('personal')"
                                        class="w-full h-20 p-2 rounded-lg border border-coral/30 focus:border-coral focus:outline-none resize-none text-sm"
                                        placeholder="WHY are you committed to these goals? Write a paragraph..."></textarea>
                                </div>

                                <!-- Things Top 3 -->
                                <div class="mb-4">
                                    <p class="font-semibold text-golden mb-2">‚ú® Thing Goals - Top 3:</p>
                                    <div id="things-top3-list" class="space-y-2 mb-2"></div>
                                    <textarea id="things-why" onchange="saveWhy('things')" oninput="autoSaveWhy('things')"
                                        class="w-full h-20 p-2 rounded-lg border border-golden/30 focus:border-golden focus:outline-none resize-none text-sm"
                                        placeholder="WHY are you committed to these goals? Write a paragraph..."></textarea>
                                </div>

                                <!-- Financial Top 3 -->
                                <div class="mb-4">
                                    <p class="font-semibold text-sage mb-2">üí∞ Financial - Top 3:</p>
                                    <div id="financial-top3-list" class="space-y-2 mb-2"></div>
                                    <textarea id="financial-why" onchange="saveWhy('financial')" oninput="autoSaveWhy('financial')"
                                        class="w-full h-20 p-2 rounded-lg border border-sage/30 focus:border-sage focus:outline-none resize-none text-sm"
                                        placeholder="WHY are you committed to these goals? Write a paragraph..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 5: Action Steps -->
                    <div class="accordion-card mb-3" data-section="actions">
                        <button onclick="toggleAccordion('actions')" class="w-full flex items-center justify-between p-4 bg-sunset/10 hover:bg-sunset/20 rounded-xl transition-all">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">‚ö°</span>
                                <div class="text-left">
                                    <p class="font-semibold text-sunset">5. Action Steps</p>
                                    <p class="text-sm text-gray-500">ONE action per goal for TODAY</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span id="actions-check" class="text-sage hidden">‚úì</span>
                                <span id="actions-arrow" class="text-sunset transition-transform">‚ñº</span>
                            </div>
                        </button>
                        <div id="actions-content" class="accordion-content">
                            <div class="p-4 border-t border-sunset/20">
                                <div class="bg-sunset/10 rounded-lg p-3 mb-3 italic text-sunset text-sm">
                                    "Never leave the site of a goal without taking some action towards its attainment. What ONE thing can you do TODAY for each goal?"
                                </div>
                                <div id="action-inputs" class="space-y-3">
                                    <!-- Will be populated dynamically -->
                                    <p class="text-gray-400 text-sm">Complete your Top 3 selections first to see your action items here.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 6: Rocking Chair Test -->
                    <div class="accordion-card mb-3" data-section="rockingchair">
                        <button onclick="toggleAccordion('rockingchair')" class="w-full flex items-center justify-between p-4 bg-peach/50 hover:bg-peach/70 rounded-xl transition-all">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">ü™ë</span>
                                <div class="text-left">
                                    <p class="font-semibold text-sunset">6. Rocking Chair Test</p>
                                    <p class="text-sm text-gray-500">Life reflection at 85-90</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span id="rockingchair-check" class="text-sage hidden">‚úì</span>
                                <span id="rockingchair-arrow" class="text-coral transition-transform">‚ñº</span>
                            </div>
                        </button>
                        <div id="rockingchair-content" class="accordion-content">
                            <div class="p-4 border-t border-peach/30">
                                <div class="bg-peach/30 rounded-lg p-3 mb-4 italic text-sunset text-sm">
                                    "Imagine you're 85-90 years old, sitting in your rocking chair, looking back on your life..."
                                </div>

                                <div class="mb-4">
                                    <label class="block text-coral font-semibold mb-2">If you DIDN'T achieve these goals, how would you feel?</label>
                                    <textarea id="rocking-pain" onchange="saveRocking()" oninput="autoSaveRocking()"
                                        class="w-full h-24 p-3 rounded-xl border-2 border-coral/30 focus:border-coral focus:outline-none resize-none"
                                        placeholder="What would you miss out on? What would it cost you?"></textarea>
                                </div>

                                <div class="mb-4">
                                    <label class="block text-sage font-semibold mb-2">If you DID achieve ALL these goals, how would you feel?</label>
                                    <textarea id="rocking-pleasure" onchange="saveRocking()" oninput="autoSaveRocking()"
                                        class="w-full h-24 p-3 rounded-xl border-2 border-sage/30 focus:border-sage focus:outline-none resize-none"
                                        placeholder="How would you feel about your life? What joy would you have experienced?"></textarea>
                                </div>

                                <button onclick="completeWorkshop()"
                                    class="w-full gradient-warm text-white font-bold py-4 rounded-xl hover:opacity-90 transition-colors text-lg">
                                    Complete Workshop! üéâ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Summary Screen -->
    <div id="summaryScreen" class="hidden min-h-screen p-4">
        <div class="max-w-4xl mx-auto">
            <div class="print-only text-center mb-8">
                <h1 class="text-3xl font-display font-bold">My Goals - Goal Setting Workshop</h1>
                <p class="text-gray-600">Tony Robbins Personal Power Day 12</p>
            </div>

            <div class="bg-white/90 backdrop-blur rounded-2xl shadow-xl p-8 print:shadow-none print:bg-white">
                <div class="flex items-center justify-between mb-6 no-print">
                    <h2 class="text-3xl font-display font-bold text-sunset">Your Goals Summary</h2>
                    <div class="flex gap-3">
                        <button onclick="hideSummary()" class="text-gray-500 hover:text-gray-700">‚Üê Back</button>
                        <button onclick="window.print()" class="bg-coral text-white px-4 py-2 rounded-lg hover:bg-coral/80">
                            üñ®Ô∏è Print Goals
                        </button>
                    </div>
                </div>

                <div class="text-center mb-6">
                    <p class="text-xl text-coral font-display" id="summaryName">Charles's Goals</p>
                    <p class="text-gray-500" id="summaryDate"></p>
                </div>

                <div class="border-t pt-6">
                    <blockquote class="text-center italic text-sunset mb-8">
                        "The purpose of a goal is not to get it. The purpose of a goal is who you become in pursuit of it."
                        <footer class="text-coral mt-2">‚Äî Tony Robbins</footer>
                    </blockquote>
                </div>

                <!-- Personal Development Goals -->
                <section class="mb-8">
                    <h3 class="text-xl font-display font-bold text-coral mb-4 flex items-center gap-2">
                        <span>üå±</span> Personal Development Goals
                    </h3>
                    <div id="summaryPersonal" class="space-y-4"></div>
                </section>

                <!-- Thing Goals -->
                <section class="mb-8">
                    <h3 class="text-xl font-display font-bold text-golden mb-4 flex items-center gap-2">
                        <span>‚ú®</span> Thing Goals
                    </h3>
                    <div id="summaryThings" class="space-y-4"></div>
                </section>

                <!-- Financial Goals -->
                <section class="mb-8">
                    <h3 class="text-xl font-display font-bold text-sage mb-4 flex items-center gap-2">
                        <span>üí∞</span> Financial Goals
                    </h3>
                    <div id="summaryFinancial" class="space-y-4"></div>
                </section>

                <!-- Rocking Chair Test -->
                <section class="mb-8 bg-sunset/5 rounded-xl p-6">
                    <h3 class="text-xl font-display font-bold text-sunset mb-4">ü™ë Rocking Chair Reflection</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <p class="text-coral font-semibold mb-2">If I don't achieve these goals:</p>
                            <p id="summaryPain" class="text-gray-700 italic"></p>
                        </div>
                        <div>
                            <p class="text-sage font-semibold mb-2">When I achieve these goals:</p>
                            <p id="summaryPleasure" class="text-gray-700 italic"></p>
                        </div>
                    </div>
                </section>

                <!-- Commitment -->
                <section class="text-center border-t pt-6">
                    <p class="text-lg text-sunset mb-4">I am committed to achieving these goals.</p>
                    <p class="text-coral font-display text-2xl" id="commitmentSignature"></p>
                    <p class="text-gray-500" id="commitmentDate"></p>
                </section>
            </div>
        </div>
    </div>

    <!-- Confetti Container -->
    <div id="confettiContainer" class="fixed inset-0 pointer-events-none z-50 overflow-hidden"></div>

    <script>
        // ==========================================
        // STATE MANAGEMENT
        // ==========================================
        let currentProfile = '';
        let workshopData = {
            personal: { goals: [], top3: [], why: '' },
            things: { goals: [], top3: [], why: '' },
            financial: { goals: [], top3: [], why: '' },
            actions: {},
            rockingChair: { pain: '', pleasure: '' },
            completed: false
        };

        let timers = {};
        let autoSaveTimeout = null;

        // ==========================================
        // INITIALIZATION
        // ==========================================
        function init() {
            // Load any existing data
        }

        function loadSavedData() {
            const saved = localStorage.getItem('goalWorkshop_' + currentProfile);
            if (saved) {
                workshopData = JSON.parse(saved);
                // Populate fields
                document.getElementById('personal-goals').value = workshopData.personal.goals.join('\n');
                document.getElementById('things-goals').value = workshopData.things.goals.join('\n');
                document.getElementById('financial-goals').value = workshopData.financial.goals.join('\n');
                document.getElementById('personal-why').value = workshopData.personal.why || '';
                document.getElementById('things-why').value = workshopData.things.why || '';
                document.getElementById('financial-why').value = workshopData.financial.why || '';
                document.getElementById('rocking-pain').value = workshopData.rockingChair.pain || '';
                document.getElementById('rocking-pleasure').value = workshopData.rockingChair.pleasure || '';

                updateAllCheckmarks();
                populateTop3Lists();
                populateActionInputs();
            }
        }

        function saveData() {
            localStorage.setItem('goalWorkshop_' + currentProfile, JSON.stringify(workshopData));
        }

        // ==========================================
        // PROFILE MANAGEMENT
        // ==========================================
        function selectProfile(name) {
            document.getElementById('customName').value = name;
        }

        function startWorkshop() {
            const customName = document.getElementById('customName').value.trim();
            if (!customName) {
                alert('Please enter or select a name');
                return;
            }
            currentProfile = customName;
            loadSavedData();

            document.getElementById('profileScreen').classList.add('hidden');
            document.getElementById('workshopScreen').classList.remove('hidden');
            document.getElementById('currentUser').textContent = currentProfile + "'s Goals";
        }

        function switchProfile() {
            saveData();
            document.getElementById('workshopScreen').classList.add('hidden');
            document.getElementById('summaryScreen').classList.add('hidden');
            document.getElementById('profileScreen').classList.remove('hidden');

            // Clear timers
            Object.keys(timers).forEach(key => {
                if (timers[key]) clearInterval(timers[key]);
            });

            // Reset data for new profile
            workshopData = {
                personal: { goals: [], top3: [], why: '' },
                things: { goals: [], top3: [], why: '' },
                financial: { goals: [], top3: [], why: '' },
                actions: {},
                rockingChair: { pain: '', pleasure: '' },
                completed: false
            };
        }

        // ==========================================
        // ACCORDION
        // ==========================================
        function toggleAccordion(section) {
            const content = document.getElementById(section + '-content');
            const arrow = document.getElementById(section + '-arrow');
            const isExpanded = content.classList.contains('expanded');

            // Close all accordions
            document.querySelectorAll('.accordion-content').forEach(el => {
                el.classList.remove('expanded');
            });
            document.querySelectorAll('[id$="-arrow"]').forEach(el => {
                el.style.transform = 'rotate(0deg)';
            });

            // Open clicked one (if it was closed)
            if (!isExpanded) {
                content.classList.add('expanded');
                arrow.style.transform = 'rotate(180deg)';

                // If opening top3 section, populate the lists
                if (section === 'top3') {
                    populateTop3Lists();
                }
                // If opening actions section, populate action inputs
                if (section === 'actions') {
                    populateActionInputs();
                }
            }
        }

        // ==========================================
        // GOALS MANAGEMENT
        // ==========================================
        function saveGoals(section) {
            const textarea = document.getElementById(section + '-goals');
            const goals = textarea.value.split('\n').filter(g => g.trim());
            workshopData[section].goals = goals;
            saveData();
            updateCheckmark(section, goals.length > 0);
        }

        function autoSave(section) {
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(() => saveGoals(section), 500);
        }

        function saveWhy(section) {
            const textarea = document.getElementById(section + '-why');
            workshopData[section].why = textarea.value;
            saveData();
        }

        function autoSaveWhy(section) {
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(() => saveWhy(section), 500);
        }

        function saveRocking() {
            workshopData.rockingChair.pain = document.getElementById('rocking-pain').value;
            workshopData.rockingChair.pleasure = document.getElementById('rocking-pleasure').value;
            saveData();
            updateCheckmark('rockingchair', workshopData.rockingChair.pain || workshopData.rockingChair.pleasure);
        }

        function autoSaveRocking() {
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(() => saveRocking(), 500);
        }

        // ==========================================
        // TOP 3 SELECTION
        // ==========================================
        function populateTop3Lists() {
            ['personal', 'things', 'financial'].forEach(section => {
                const container = document.getElementById(section + '-top3-list');
                const goals = workshopData[section].goals;

                if (goals.length === 0) {
                    container.innerHTML = '<p class="text-gray-400 text-sm">Add goals in section above first</p>';
                    return;
                }

                container.innerHTML = goals.map((goal, index) => `
                    <label class="flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" ${workshopData[section].top3.includes(index) ? 'checked' : ''}
                            onchange="toggleTop3('${section}', ${index})"
                            class="w-4 h-4 text-coral rounded">
                        <span class="text-sm">${goal}</span>
                    </label>
                `).join('');
            });
        }

        function toggleTop3(section, index) {
            const top3 = workshopData[section].top3;
            const pos = top3.indexOf(index);

            if (pos > -1) {
                top3.splice(pos, 1);
            } else if (top3.length < 3) {
                top3.push(index);
            } else {
                // Already have 3, uncheck this one
                event.target.checked = false;
                return;
            }

            saveData();
            updateCheckmark('top3', hasTop3Selected());
        }

        function hasTop3Selected() {
            return workshopData.personal.top3.length > 0 ||
                   workshopData.things.top3.length > 0 ||
                   workshopData.financial.top3.length > 0;
        }

        // ==========================================
        // ACTION INPUTS
        // ==========================================
        function populateActionInputs() {
            const container = document.getElementById('action-inputs');
            let html = '';
            let hasGoals = false;

            ['personal', 'things', 'financial'].forEach(section => {
                const top3 = workshopData[section].top3;
                const goals = workshopData[section].goals;
                const sectionName = section === 'personal' ? 'üå± Personal' :
                                   section === 'things' ? '‚ú® Things' : 'üí∞ Financial';

                top3.forEach((goalIndex, i) => {
                    const goal = goals[goalIndex];
                    if (goal) {
                        hasGoals = true;
                        const key = `${section}_${i}`;
                        html += `
                            <div class="bg-gray-50 rounded-lg p-3">
                                <p class="font-semibold text-sunset text-sm mb-1">${sectionName}: ${goal}</p>
                                <input type="text"
                                    class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:border-coral focus:outline-none text-sm"
                                    placeholder="One action I'll take TODAY..."
                                    value="${workshopData.actions[key] || ''}"
                                    onchange="saveAction('${key}', this.value)"
                                    oninput="autoSaveAction('${key}', this.value)">
                            </div>
                        `;
                    }
                });
            });

            if (!hasGoals) {
                html = '<p class="text-gray-400 text-sm">Complete your Top 3 selections first to see your action items here.</p>';
            }

            container.innerHTML = html;
            updateCheckmark('actions', Object.keys(workshopData.actions).length > 0);
        }

        function saveAction(key, value) {
            workshopData.actions[key] = value;
            saveData();
            updateCheckmark('actions', Object.keys(workshopData.actions).some(k => workshopData.actions[k]));
        }

        function autoSaveAction(key, value) {
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(() => saveAction(key, value), 500);
        }

        // ==========================================
        // TIMER
        // ==========================================
        function startSectionTimer(section, seconds) {
            // Clear existing timer for this section
            if (timers[section]) {
                clearInterval(timers[section]);
            }

            let remaining = seconds;
            const display = document.getElementById(section + '-timer');

            function updateDisplay() {
                const mins = Math.floor(remaining / 60);
                const secs = remaining % 60;
                display.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;

                if (remaining <= 30) {
                    display.classList.add('pulse-warning');
                }
            }

            updateDisplay();

            timers[section] = setInterval(() => {
                remaining--;
                updateDisplay();

                if (remaining <= 0) {
                    clearInterval(timers[section]);
                    display.textContent = "Time's up!";
                    display.classList.remove('pulse-warning');
                }
            }, 1000);
        }

        // ==========================================
        // CHECKMARKS
        // ==========================================
        function updateCheckmark(section, hasContent) {
            const check = document.getElementById(section + '-check');
            if (check) {
                check.classList.toggle('hidden', !hasContent);
            }
        }

        function updateAllCheckmarks() {
            updateCheckmark('personal', workshopData.personal.goals.length > 0);
            updateCheckmark('things', workshopData.things.goals.length > 0);
            updateCheckmark('financial', workshopData.financial.goals.length > 0);
            updateCheckmark('top3', hasTop3Selected());
            updateCheckmark('actions', Object.keys(workshopData.actions).some(k => workshopData.actions[k]));
            updateCheckmark('rockingchair', workshopData.rockingChair.pain || workshopData.rockingChair.pleasure);
        }

        // ==========================================
        // COMPLETE WORKSHOP
        // ==========================================
        function completeWorkshop() {
            saveRocking();
            workshopData.completed = true;
            saveData();

            showConfetti();
            setTimeout(() => showSummary(), 1500);
        }

        // ==========================================
        // SUMMARY
        // ==========================================
        function showSummary() {
            document.getElementById('workshopScreen').classList.add('hidden');
            document.getElementById('summaryScreen').classList.remove('hidden');

            document.getElementById('summaryName').textContent = currentProfile + "'s Goals";
            document.getElementById('summaryDate').textContent = new Date().toLocaleDateString('en-US', {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
            document.getElementById('commitmentSignature').textContent = currentProfile;
            document.getElementById('commitmentDate').textContent = new Date().toLocaleDateString();

            populateSummarySection('summaryPersonal', 'personal');
            populateSummarySection('summaryThings', 'things');
            populateSummarySection('summaryFinancial', 'financial');

            document.getElementById('summaryPain').textContent = workshopData.rockingChair.pain || 'Not completed';
            document.getElementById('summaryPleasure').textContent = workshopData.rockingChair.pleasure || 'Not completed';
        }

        function populateSummarySection(containerId, section) {
            const container = document.getElementById(containerId);
            const top3 = workshopData[section].top3;
            const goals = workshopData[section].goals;
            const why = workshopData[section].why;

            if (top3.length === 0) {
                container.innerHTML = '<p class="text-gray-400 italic">No goals selected</p>';
                return;
            }

            let html = '';
            top3.forEach((goalIndex, i) => {
                const goal = goals[goalIndex];
                const action = workshopData.actions[`${section}_${i}`] || '';
                if (goal) {
                    html += `
                        <div class="bg-gray-50 rounded-lg p-4">
                            <p class="font-bold text-sunset">${i + 1}. ${goal}</p>
                            ${action ? `<p class="text-coral mt-2"><strong>Action:</strong> ${action}</p>` : ''}
                        </div>
                    `;
                }
            });

            if (why) {
                html += `<div class="mt-2 p-3 bg-golden/10 rounded-lg italic text-sunset text-sm">"${why}"</div>`;
            }

            container.innerHTML = html;
        }

        function hideSummary() {
            document.getElementById('summaryScreen').classList.add('hidden');
            document.getElementById('workshopScreen').classList.remove('hidden');
        }

        // ==========================================
        // CONFETTI
        // ==========================================
        function showConfetti() {
            const container = document.getElementById('confettiContainer');
            const colors = ['#e07a5f', '#f2cc8f', '#81b29a', '#3d405b', '#f4a261'];

            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti absolute w-3 h-3 rounded';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(confetti);
            }

            setTimeout(() => container.innerHTML = '', 5000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
